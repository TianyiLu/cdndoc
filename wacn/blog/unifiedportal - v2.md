# 新版Azure China CDN管理门户正式上线

经过产品团队的不懈努力，新版Azure China CDN管理门户先开放公共预览版给所有用户。

新版管理门户经过全新的设计，对功能模块进行归类，除了在使用易用性、视觉展示效果等方面有所提升外，还增加了多个用户需求很高的功能模块。本文简要介绍了新版设计和功能模块，更多详细内容请参考[Azure China CDN 新版管理门户](https://www.azure.cn/documentation/articles/cdn-management-v2-portal-how-to-use/)。

## 入口

公共预览版，访问新版管理门户需要用户从[Azure门户预览](https://portal.azure.cn/)点击“管理”按钮会跳转到老版管理门户，用户可以在概览界面点击“访问新站点”跳转到新版管理门户。

![][16]

## 概览
下面是新版CDN管理门户的首页：

![][1]

## **新版管理门户功能如下：**

+ [域名管理](#step2)
+ [监控和分析](#step3)
+ [内容管理](#step4)
+ [自助服务工具](#step5)
+ [安全管理](#step6)

其中安全管理是新增功能模块，新上线的Azure China CDN Restful API中的验证和授权方式基于接口密钥需要在功能模块中申请。

接下来简单介绍一下每个功能模块。

## **域名管理**<a id="step2"></a>

单击左侧导航窗格中 “域名管理”时，将显示当前Azure订阅下已经创建的所有CDN加速域名的列表视图。 可以在搜索框内搜索需要管理的域名。也可以通过Azure订阅下拉列表选择不同的订阅查看不同订阅下的CDN加速域名信息。同时可以点击相应的域名行，对选中域名进行**“修改配置”**，**“缓存规则配置”**和**“访问控制管理”**等操作。

### **加速域名列表视图**

![][3]


#### **属性视图**
选中域名行后，右边会出现可以对改域名进行的操作的视图。属性视图可以修改源站域名或者Host Header。

![][17]

在此简单说明下Host Header表示 CDN 回源时，HTTP 请求头中的 HOST 字段的值。这个值一般是域名形式的字符串，被源站用来识别是否与源站服务器上配置的域名相同。

#### **缓存规则配置视图**
 
![][4]

选中域名行后，右边会出现可以对改域名进行的操作的视图。系统会根据缓存规则设置默认规则。用户可以根据需求加以调整。用户规则优先匹配，如果用户规则未命中，则逐条执行系统默认缓存规则。


>**注意**

>- 不缓存规则优先执行
>- 缓存规则由上至下执行


#### **访问控制管理**

通过访问控制管理，用户可以设置配置Referer黑白名单，从而实现防盗链。

![][5]

当防盗链开启之后，便可以编辑外链规则。每条规则是一个路径和文件名的组合。比如/*.png表示根目录下所有的png文件。

## **监控和分析**<a id="step3"></a>

### **流量带宽**

你可以选择要查看的自定义速域名（单个域名或全部），时间范围，单击**刷新**按钮后界面将显示符合条件的流量统计报表、带宽统计报表，数据格式及含义请参见实际页面中的详细说明。

![][6]


## **内容管理**<a id="step4"></a>
内容管理下面可以针对文件或目录进行缓存刷新或者预加载。
### **缓存刷新**

单击左侧导航窗格中“缓存刷新”，可以对指定的文件或者目录进行手动刷新。

#### **缓存刷新列表视图**

在缓存刷新列表视图右边的“查询历史数据”视图中，选择要查询的域名、时间范围、状态，单击**刷新**后界面将显示符合条件的缓存刷新记录。
![][8]

### **预加载**
预加载是指预先将指定URL的内容从源站缓存到CDN节点，这样可以消除用户第一次访问该资源时的等待时间。预加载一般被用在进行大文件分发时的场景，可以有效的提升用户访问体验。


#### **预加载列表视图**

在预加载视图右边的“查询历史数据”视图中，选择要查询的域名、时间范围、状态，单击**刷新**后界面将显示符合条件的预加载记录。

![][11]

## **自助服务工具**<a id="step5"></a>
您可以在自助服务工具模块，进行服务检查查看CDN节点是否可用，也可以在该模块进行日志下载设置。
### **服务检查**
用户在创建CDN服务终节点后，可以在“服务检查”视图做一些基本的检查。我们强烈建议用户在CNAME操作之前，做一下服务检查。

![][15]

### **日志下载**
单击左侧的导航窗格中 “日志下载”，可以对指定的域名设置CDN原始日志下载相关参数。

#### **日志下载视图**
日志下载需要用户首先提供一个 Azure Storage Account 用以存放CDN日志，点击“设置”进行设置。

![][13]


## 密钥管理<a id="step6"></a>

单击左侧导航窗格中“密钥管理”，可以生成、创建、删除Azure CDN API接口所需的访问密钥。

### 已有密钥列表视图

该视图显示用户所有的密钥。

![][18]

###密钥详细信息

选择一个密钥，可以查看此密钥的详细信息，也可以对此密钥进行修改操作，如更新、禁用和删除。

![][19]

可以更新、禁用、启用和删除当前密钥。

###创建密钥

可以创建一个新密钥。

-   名称，密钥的用户友好名称
-   只读或读写权限


[1]: ./images/001.png
[2]: ./images/002.png
[3]: ./images/003.png
[4]: ./images/cache-policy-2.png
[5]: ./images/access-control.png
[6]: ./images/004.png
[7]: ./images/005.png
[8]: ./images/006.png
[9]: ./images/007.png
[10]: ./images/008.png
[11]: ./images/prefetch-1.png
[12]: ./images/prefetch-2.png
[13]: ./images/log-download-1.png
[14]: ./images/log-download-2.png
[15]: ./images/service-check.png
[16]: ./images/version-change.png
[17]: ./images/property.png
[18]: ./images/key-1.png
[19]: ./images/key-2.png
[20]: ./images/key-3.png
[21]: ./images/key-4.png